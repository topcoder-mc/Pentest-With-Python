
from unittest import TestCase, main


class UnitTest(TestCase):

    def test_mysql_select(self):

        from mysql.connector import (
            connect as mysql_connect,
            Error as mysql_error
        )
        from utils.config_manager import ConfigManager
        
        config_manager = ConfigManager()

        try:
            connection = mysql_connect(
                host=config_manager.get.DataBase.MySql.Host,
                database=config_manager.get.DataBase.MySql.Database,
                user=config_manager.get.DataBase.MySql.User,
                password=config_manager.get.DataBase.MySql.Passwd
            )
        except mysql_error as error:
            print("We have error as " + error)

        if connection.is_connected():
            print("[+] MySql Connection Open Successfully")

            sql_select_Query = "SELECT EXISTS (SELECT 1 FROM users);"
            cursor = connection.cursor()
            cursor.execute(sql_select_Query)
            records = cursor.fetchall()
            print(records[0][0])

        else:
            raise "We have error for connecting to database !!!"

if __name__ == "__main__":
    main()
